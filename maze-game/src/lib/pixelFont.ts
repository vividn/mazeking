// 8-cell tall pixel font optimized for readability at thumbnail size
// Each character is represented as a 2D boolean array where true = filled/wall

type CharPattern = boolean[][];

// Helper to convert string patterns to boolean arrays
function p(rows: string[]): CharPattern {
  return rows.map(row => row.split('').map(c => c === '#'));
}

export const PIXEL_FONT: Record<string, CharPattern> = {
  'A': p([
    '.###.',
    '##.##',
    '##.##',
    '#####',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
  ]),
  'B': p([
    '####.',
    '##.##',
    '##.##',
    '####.',
    '##.##',
    '##.##',
    '##.##',
    '####.',
  ]),
  'C': p([
    '.####',
    '##...',
    '##...',
    '##...',
    '##...',
    '##...',
    '##...',
    '.####',
  ]),
  'D': p([
    '####.',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '####.',
  ]),
  'E': p([
    '#####',
    '##...',
    '##...',
    '####.',
    '##...',
    '##...',
    '##...',
    '#####',
  ]),
  'F': p([
    '#####',
    '##...',
    '##...',
    '####.',
    '##...',
    '##...',
    '##...',
    '##...',
  ]),
  'G': p([
    '.####',
    '##...',
    '##...',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '.####',
  ]),
  'H': p([
    '##.##',
    '##.##',
    '##.##',
    '#####',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
  ]),
  'I': p([
    '#####',
    '..#..',
    '..#..',
    '..#..',
    '..#..',
    '..#..',
    '..#..',
    '#####',
  ]),
  'J': p([
    '#####',
    '...##',
    '...##',
    '...##',
    '...##',
    '##.##',
    '##.##',
    '.###.',
  ]),
  'K': p([
    '##.##',
    '##.##',
    '##.#.',
    '###..',
    '###..',
    '##.#.',
    '##.##',
    '##.##',
  ]),
  'L': p([
    '##...',
    '##...',
    '##...',
    '##...',
    '##...',
    '##...',
    '##...',
    '#####',
  ]),
  'M': p([
    '##.##',
    '#####',
    '#####',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
  ]),
  'N': p([
    '##.##',
    '###.#',
    '###.#',
    '#####',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
  ]),
  'O': p([
    '.###.',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '.###.',
  ]),
  'P': p([
    '####.',
    '##.##',
    '##.##',
    '####.',
    '##...',
    '##...',
    '##...',
    '##...',
  ]),
  'Q': p([
    '.###.',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '.###.',
    '...##',
  ]),
  'R': p([
    '####.',
    '##.##',
    '##.##',
    '####.',
    '###..',
    '##.#.',
    '##.##',
    '##.##',
  ]),
  'S': p([
    '.####',
    '##...',
    '##...',
    '.###.',
    '...##',
    '...##',
    '...##',
    '####.',
  ]),
  'T': p([
    '#####',
    '..#..',
    '..#..',
    '..#..',
    '..#..',
    '..#..',
    '..#..',
    '..#..',
  ]),
  'U': p([
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '.###.',
  ]),
  'V': p([
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '.###.',
    '..#..',
  ]),
  'W': p([
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '#####',
    '#####',
    '##.##',
  ]),
  'X': p([
    '##.##',
    '##.##',
    '.###.',
    '..#..',
    '..#..',
    '.###.',
    '##.##',
    '##.##',
  ]),
  'Y': p([
    '##.##',
    '##.##',
    '##.##',
    '.###.',
    '..#..',
    '..#..',
    '..#..',
    '..#..',
  ]),
  'Z': p([
    '#####',
    '...##',
    '..##.',
    '..#..',
    '.#...',
    '##...',
    '##...',
    '#####',
  ]),
  '0': p([
    '.###.',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '##.##',
    '.###.',
  ]),
  '1': p([
    '..#..',
    '.##..',
    '..#..',
    '..#..',
    '..#..',
    '..#..',
    '..#..',
    '.###.',
  ]),
  '2': p([
    '.###.',
    '##.##',
    '...##',
    '..##.',
    '.##..',
    '##...',
    '##...',
    '#####',
  ]),
  '3': p([
    '.###.',
    '##.##',
    '...##',
    '..##.',
    '...##',
    '...##',
    '##.##',
    '.###.',
  ]),
  '4': p([
    '##.##',
    '##.##',
    '##.##',
    '#####',
    '...##',
    '...##',
    '...##',
    '...##',
  ]),
  '5': p([
    '#####',
    '##...',
    '##...',
    '####.',
    '...##',
    '...##',
    '##.##',
    '.###.',
  ]),
  '6': p([
    '.###.',
    '##...',
    '##...',
    '####.',
    '##.##',
    '##.##',
    '##.##',
    '.###.',
  ]),
  '7': p([
    '#####',
    '...##',
    '...##',
    '..##.',
    '..#..',
    '..#..',
    '..#..',
    '..#..',
  ]),
  '8': p([
    '.###.',
    '##.##',
    '##.##',
    '.###.',
    '##.##',
    '##.##',
    '##.##',
    '.###.',
  ]),
  '9': p([
    '.###.',
    '##.##',
    '##.##',
    '.####',
    '...##',
    '...##',
    '...##',
    '.###.',
  ]),
  ' ': p([
    '...',
    '...',
    '...',
    '...',
    '...',
    '...',
    '...',
    '...',
  ]),
  '.': p([
    '..',
    '..',
    '..',
    '..',
    '..',
    '..',
    '##',
    '##',
  ]),
  ',': p([
    '..',
    '..',
    '..',
    '..',
    '..',
    '..',
    '.#',
    '#.',
  ]),
  '!': p([
    '##',
    '##',
    '##',
    '##',
    '##',
    '..',
    '##',
    '##',
  ]),
  '?': p([
    '.###.',
    '##.##',
    '...##',
    '..##.',
    '..#..',
    '.....',
    '..#..',
    '..#..',
  ]),
  "'": p([
    '##',
    '##',
    '#.',
    '..',
    '..',
    '..',
    '..',
    '..',
  ]),
  '-': p([
    '....',
    '....',
    '....',
    '####',
    '....',
    '....',
    '....',
    '....',
  ]),
  ':': p([
    '..',
    '##',
    '##',
    '..',
    '..',
    '##',
    '##',
    '..',
  ]),
};

export function getCharWidth(char: string): number {
  const pattern = PIXEL_FONT[char.toUpperCase()];
  if (!pattern || pattern.length === 0) return 3; // default width for unknown
  return pattern[0].length;
}

export function getTextDimensions(text: string): { width: number; height: number } {
  const upperText = text.toUpperCase();
  let width = 0;

  for (let i = 0; i < upperText.length; i++) {
    const char = upperText[i];
    width += getCharWidth(char);
    if (i < upperText.length - 1) {
      width += 1; // spacing between characters
    }
  }

  return { width, height: 8 };
}
